/*!CK:3655710315!*//*1457469506,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["cKnY2"]); }

__d("PUWErrorCodes",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={BAD_JPEG:9901,WORKER_TERMINATED:9902,UNKNOWN_RESIZE_ERROR:9903,WORKER_ABORT:9904};},null);
__d('Emscripten',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();f.exports={isSupported:function(){return (typeof Int32Array!=='undefined'&&typeof Float64Array!=='undefined'&&!!new Int32Array(1).subarray&&!!new Int32Array(1).set);}};},null);
__d('PooledWebWorker',['WebWorker'],function a(b,c,d,e,f,g){var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('WebWorker'));i=h&&h.prototype;function j(k,l,m){'use strict';i.constructor.call(this,m);this.$PooledWebWorker1=l;this.$PooledWebWorker2=k;}j.prototype.getIndex=function(){'use strict';return this.$PooledWebWorker1;};j.prototype.getPool=function(){'use strict';return this.$PooledWebWorker2;};f.exports=j;},null);
__d('WebWorkerPool',['PooledWebWorker','emptyFunction'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();h.isSupported=function(){'use strict';return c('PooledWebWorker').isSupported();};function h(i,j){'use strict';this.$WebWorkerPool1=[];for(var k=0;k<j;k++)this.$WebWorkerPool1.push(new (c('PooledWebWorker'))(this,k,i).setErrorHandler(this.$WebWorkerPool2).setMessageHandler(this.$WebWorkerPool3).execute());this.$WebWorkerPool4=0;}h.prototype.setMessageHandler=function(i){'use strict';this.$WebWorkerPool5=i||c('emptyFunction');return this;};h.prototype.setAllowCrossPageTransition=function(i){'use strict';this.$WebWorkerPool1.forEach(function(j){return j.setAllowCrossPageTransition(i);});return this;};h.prototype.setErrorHandler=function(i){'use strict';this.$WebWorkerPool6=i||c('emptyFunction');return this;};h.prototype.postMessage=function(){'use strict';var i=this.getWorker();for(var j=arguments.length,k=Array(j),l=0;l<j;l++)k[l]=arguments[l];i.postMessage.apply(i,k);return i;};h.prototype.$WebWorkerPool3=function(){'use strict';for(var i=arguments.length,j=Array(i),k=0;k<i;k++)j[k]=arguments[k];j.unshift(this);this.getPool().$WebWorkerPool5.apply(this.getPool(),j);};h.prototype.$WebWorkerPool2=function(){'use strict';for(var i=arguments.length,j=Array(i),k=0;k<i;k++)j[k]=arguments[k];j.unshift(this);return this.getPool().$WebWorkerPool6.apply(this.getPool(),j);};h.prototype.getWorker=function(){'use strict';var i=this.$WebWorkerPool1[this.$WebWorkerPool4];this.$WebWorkerPool4=(this.$WebWorkerPool4+1)%this.$WebWorkerPool1.length;return i;};f.exports=h;},null);
__d('JpegResizer',['Emscripten','JpegResizerConfig','JpegResizeWorkerResource','WebWorker','WebWorkerPool','PUWErrorCodes'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=null;i.isSupported=function(){'use strict';return c('WebWorkerPool').isSupported()&&c('Emscripten').isSupported()&&!c('JpegResizerConfig').isGKBlacklisted;};i.getSingleton=function(j){'use strict';if(!h)h=new i(j||i.DEFAULT_POOL_SIZE).setAllowCrossPageTransition(true);return h;};i.prepareResource=function(j){'use strict';c('WebWorker').prepareResource(c('JpegResizeWorkerResource'),j);};function i(j){'use strict';j=j||i.DEFAULT_POOL_SIZE;c('WebWorker').prepareResource(c('JpegResizeWorkerResource'));this.$JpegResizer1=new (c('WebWorkerPool'))(c('JpegResizeWorkerResource'),j).setErrorHandler(this.$JpegResizer2.bind(this)).setMessageHandler(this.$JpegResizer3.bind(this));this.$JpegResizer4={};this.$JpegResizer5=i.DEFAULT_RESIZE_HEIGHT;this.$JpegResizer6=i.DEFAULT_RESIZE_WIDTH;}i.prototype.setHighQuality=function(j){'use strict';if(j){this.$JpegResizer5=i.DEFAULT_RESIZE_HEIGHT;this.$JpegResizer6=i.DEFAULT_RESIZE_WIDTH;}else{this.$JpegResizer5=i.LOW_QUALITY_RESIZE_HEIGHT;this.$JpegResizer6=i.LOW_QUALITY_RESIZE_WIDTH;}return this;};i.prototype.setAllowCrossPageTransition=function(j){'use strict';this.$JpegResizer1.setAllowCrossPageTransition(j);return this;};i.prototype.resizeBlob=function(j,k,l){'use strict';var m=this.$JpegResizer1.getWorker();if(m.isCurrentState('terminated')){var n=new Error('Worker terminated');n.code=c('PUWErrorCodes').WORKER_TERMINATED;k(n);return this;}var o=m.postMessage({blob:j,height:this.$JpegResizer5,width:this.$JpegResizer6}).getIndex();this.$JpegResizer7(o).unshift({done:k,progress:l});return this;};i.prototype.$JpegResizer7=function(j){'use strict';if(!this.$JpegResizer4.hasOwnProperty(j))this.$JpegResizer4[j]=[];return this.$JpegResizer4[j];};i.prototype.$JpegResizer2=function(j,k){'use strict';j.terminate();var l=this.$JpegResizer7(j.getIndex());this.$JpegResizer8(k);l.forEach(function(m){return m.done(k);});l.length=0;};i.prototype.$JpegResizer3=function(j,k){'use strict';if(k.error)this.$JpegResizer8(k.error);if(k.done){this.$JpegResizer7(j.getIndex()).pop().done(k.error,k.blob,k.skipped);}else{var l=this.$JpegResizer7(j.getIndex()),m=l[l.length-1].progress;if(m)m({written:k.written,total:k.total});}};i.prototype.$JpegResizer8=function(j){'use strict';var k=j.message;if(k.indexOf('Not a JPEG file')!==-1){j.code=c('PUWErrorCodes').BAD_JPEG;}else if(k.indexOf('abort()')!==-1){j.code=c('PUWErrorCodes').WORKER_ABORT;}else j.code=c('PUWErrorCodes').UNKNOWN_RESIZE_ERROR;};i.DEFAULT_POOL_SIZE=3;i.DEFAULT_RESIZE_HEIGHT=2048;i.DEFAULT_RESIZE_WIDTH=2048;i.LOW_QUALITY_RESIZE_HEIGHT=960;i.LOW_QUALITY_RESIZE_WIDTH=960;f.exports=i;},null);
__d('TimelineMapScrollableArea',['Animation','ArbiterMixin','CSS','DOM','Event','Run','Scroll','SimpleDrag','Style','Vector','$','shield'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i,j){i&&this.init(c('$')(i),j);}Object.assign(h.prototype,c('ArbiterMixin'),{init:function(i,j){j=j||{};this._elem=i;this._wrap=c('DOM').find(i,'div.fbScrollableAreaWrap');this._body=c('DOM').find(this._wrap,'div.fbScrollableAreaBody');this._track=c('DOM').find(i,'div.fbScrollableAreaTrack');this._gripper=c('DOM').find(this._track,'div.fbScrollableAreaGripper');this._options=j;this.adjustGripper();this._listeners=[c('Event').listen(this._wrap,'scroll',this._handleScroll.bind(this))];if(j.fade!==false)this._listeners.push(c('Event').listen(i,'mouseenter',c('shield')(this.adjustGripper,this)),c('Event').listen(i,'mouseenter',c('shield')(this.showScrollbar,this)),c('Event').listen(i,'mousemove',this._handleMousemove.bind(this)),c('Event').listen(i,'mouseout',c('shield')(this.hideScrollbar,this)));if(j.fade!==undefined)this._listeners.push(c('Event').listen(this._track,'click',this.clickToScroll.bind(this)));if(j.verticalscroll)this._listeners.push(c('Event').listen(this._wrap,'mousewheel',this.mouseWheel.bind(this)),c('Event').listen(this._wrap,'DOMMouseScroll',this.mouseWheel.bind(this)));this.initDrag();if(!j.persistent)c('Run').onLeave(this.destroy.bind(this));},getRoot:function(){return this._elem;},initDrag:function(){var i=new (c('SimpleDrag'))(this._gripper);i.subscribe('start',function(j,event){if(!(event.which&&event.which===1||event.button&&event.button===1))return;this.inform('dragstart');var k=c('Vector').getEventPosition(event).x,l=this._gripper.offsetLeft,m=i.subscribe('update',function(o,p){var q=c('Vector').getEventPosition(p).x-k,r=this._elem.clientWidth,s=this._body.offsetWidth,t=this._track.offsetWidth,u=r/s*t,v=s-this._wrap.offsetWidth,w=l+q,x=t-u;w=Math.max(Math.min(w,x),0);var y=w/x*v;c('Scroll').setLeft(this._wrap,y);}.bind(this)),n=i.subscribe('end',function(){i.unsubscribe(m);i.unsubscribe(n);this.inform('dragend');}.bind(this));}.bind(this));},adjustGripper:function(){var i=this._elem.clientWidth,j=this._body.offsetWidth,k=this._track.offsetWidth,l=i/j*k;if(l<k){c('Style').set(this._gripper,'width',l+'px');var m=c('Scroll').getLeft(this._wrap)/j*k;c('Style').set(this._gripper,'left',m+'px');c('CSS').show(this._gripper);}else c('CSS').hide(this._gripper);this._checkContentBoundaries();return this;},_checkContentBoundaries:function(){var i=c('Scroll').getLeft(this._wrap),j=this._wrap.scrollWidth-this._wrap.clientWidth;c('CSS').conditionClass(this._elem,'contentBefore',i>0);c('CSS').conditionClass(this._elem,'contentAfter',i<j);},destroy:function(){this._listeners.forEach(function(i){i.remove();});this._listeners.length=0;},_handleMousemove:function(event){var i=c('Vector').getElementPosition(this._track).y,j=c('Vector').getElementDimensions(this._track).y;if(Math.abs(i+j/2-c('Vector').getEventPosition(event).y)<25){this.showScrollbar(false);}else this.hideScrollbar();},_handleScroll:function(event){this.adjustGripper();if(this._options.fade!==false)this.showScrollbar();},hideScrollbar:function(){if(!this._scrollbarVisible)return this;this._scrollbarVisible=false;if(this._hideTimeout){clearTimeout(this._hideTimeout);this._hideTimeout=null;}this._hideTimeout=setTimeout(function(){if(this._scrollbarAnimation){this._scrollbarAnimation.stop();this._scrollbarAnimation=null;}this._scrollbarAnimation=new (c('Animation'))(this._track).from('opacity',1).to('opacity',0).duration(250).ondone(c('CSS').addClass.bind(null,this._track,'invisible_elem')).go();}.bind(this),750);return this;},showScrollbar:function(i){if(this._scrollbarVisible)return this;this._scrollbarVisible=true;if(this._hideTimeout){clearTimeout(this._hideTimeout);this._hideTimeout=null;}if(this._scrollbarAnimation){this._scrollbarAnimation.stop();this._scrollbarAnimation=null;}this.adjustGripper();c('Style').set(this._track,'opacity',1);c('CSS').removeClass(this._track,'invisible_elem');if(i!==false)this.hideScrollbar();return this;},clickToScroll:function(event){var i=c('Vector').getEventPosition(event).x,j=this._elem.clientWidth,k=this._body.offsetWidth,l=this._track.offsetWidth,m=j/k*l,n=c('Vector').getElementPosition(this._gripper);if(i>=n.x&&i<=n.x+m)return;var o=i<n.x?-1:1,p=this._wrap.offsetWidth*.8*o;this.scrollBy(p);},scrollBy:function(i){this.setScroll(c('Scroll').getLeft(this._wrap)+i);},getMaxBodyOffset:function(){return this._body.offsetWidth-this._wrap.offsetWidth;},setScroll:function(i){var j=i;j=Math.max(Math.min(j,this.getMaxBodyOffset()),0);c('Scroll').setLeft(this._wrap,j);},scrollIntoView:function(i){var j=this._wrap.clientWidth,k=i.offsetWidth,l=c('Scroll').getLeft(this._wrap),m=l+j,n=i.offsetLeft,o=n+k;if(n<l||j<k){this.setScroll(n);}else if(o>m)this.setScroll(l+(o-m));},mouseWheel:function(event){if(this.getMaxBodyOffset()<=0)return;var i=0;if(event.wheelDelta){var j=event.wheelDelta;if(event.wheelDeltaX&&event.wheelDeltaY)j=Math.abs(event.wheelDeltaX)>Math.abs(event.wheelDeltaY)?event.wheelDeltaX:event.wheelDeltaY;i=-j*10/40;}else if(event.detail)i=event.detail*10;this.scrollBy(i);event.prevent();}});f.exports=b.TimelineMapScrollableArea||h;},null);
__d("ImageMetadata",["regeneratorRuntime","Promise"],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i){"use strict";this.$ImageMetadata1=i;this.$ImageMetadata2();}h.prototype.$ImageMetadata2=function(){"use strict";};h.genMetadataFromBlob=function i(j){return c("regeneratorRuntime").async(function k(l){while(1)switch(l.prev=l.next){case 0:"use strict";l.t0=c("regeneratorRuntime");l.t1=h;l.next=5;return c("regeneratorRuntime").awrap(h.$ImageMetadata3(j));case 5:l.t2=l.sent;l.t3=l.t1.genMetadataFromArrayBuffer.call(l.t1,l.t2);l.next=9;return l.t0.awrap.call(l.t0,l.t3);case 9:return l.abrupt("return",l.sent);case 10:case "end":return l.stop();}},null,this);};h.genMetadataFromArrayBuffer=function i(j){return c("regeneratorRuntime").async(function k(l){while(1)switch(l.prev=l.next){case 0:"use strict";return l.abrupt("return",new h(new Uint8Array(j)));case 2:case "end":return l.stop();}},null,this);};h.$ImageMetadata3=function(i){"use strict";return new (c("Promise"))(function(j,k){var l=new b.FileReader();l.onabort=k;l.onerror=k;l.onload=j;l.readAsArrayBuffer(i);});};f.exports=h;},null);
__d('SphericalImage',['regeneratorRuntime','ImageMetadata'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=function j(k,l){return c('regeneratorRuntime').async(function m(n){while(1)switch(n.prev=n.next){case 0:return n.abrupt('return',false);case 1:case 'end':return n.stop();}},null,this);},i={isSphericalImage:h};f.exports=i;},null);
__d('XComposerPhotoUploader',['regeneratorRuntime','Promise','AsyncUploadRequest','FileInputUploader','JSLogger','PhotosMimeType','PhotosUploadID','ImageMetadata','SphericalImage','curry','emptyFunction','performanceNow'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i){this.$XComposerPhotoUploader2=i.uploadData||{};this.$XComposerPhotoUploader1=i.uploadEndpoint;this.$XComposerPhotoUploader3=i.retryLimit;this.$XComposerPhotoUploader4=i.concurrentLimit;this.$XComposerPhotoUploader5=i.resizer;this.$XComposerPhotoUploader6=i.onUploadEnqueued||c('emptyFunction');this.$XComposerPhotoUploader7=i.onUploadsEnqueued||c('emptyFunction');this.$XComposerPhotoUploader8=i.onResizeStart||c('emptyFunction');this.$XComposerPhotoUploader11=i.onResizeProgress||c('emptyFunction');this.$XComposerPhotoUploader9=i.onResizeSuccess||c('emptyFunction');this.$XComposerPhotoUploader10=i.onResizeFailure||c('emptyFunction');this.$XComposerPhotoUploader12=i.onUploadSent||c('emptyFunction');this.$XComposerPhotoUploader13=i.onUploadStart||c('emptyFunction');this.$XComposerPhotoUploader14=i.onUploadProgress||c('emptyFunction');this.$XComposerPhotoUploader15=i.onUploadSuccess||c('emptyFunction');this.$XComposerPhotoUploader16=i.onUploadFailure||c('emptyFunction');this.$XComposerPhotoUploader17=c('JSLogger').create('composer');}h.prototype.upload=function(i){var j=Object.assign({},this.$XComposerPhotoUploader2),k=null;if(!this.$XComposerPhotoUploader18(i)){var l=c('PhotosUploadID').getNewID();i.uploadID=l;j.upload_id=l;this.$XComposerPhotoUploader6({uploadID:l,fileName:i.value.split('/').pop().split('\\').pop()});}else{k=Array.from(i.files);k.forEach(function(o){if(!o.uploadID)o.uploadID=c('PhotosUploadID').getNewID();this.$XComposerPhotoUploader6({uploadID:o.uploadID,fileName:o.name});}.bind(this));}this.$XComposerPhotoUploader7();var m=new (c('FileInputUploader'))(i).setURI(this.$XComposerPhotoUploader1).setData(j).setAllowCrossOrigin(true).setNetworkErrorRetryLimit(this.$XComposerPhotoUploader3).setUploadInParallel(true);if(k&&k.length>0){m.setFiles({farr:k});if(this.$XComposerPhotoUploader5)m.setPreprocessHandler(this.$XComposerPhotoUploader19.bind(this));if(this.$XComposerPhotoUploader4)m.setConcurrentLimit(this.$XComposerPhotoUploader4);}m.subscribe('progress',function(o,p){return (this.$XComposerPhotoUploader14(this.$XComposerPhotoUploader20(p,i),p));}.bind(this));m.subscribe('failure',function(o,p){return (this.$XComposerPhotoUploader16(this.$XComposerPhotoUploader20(p,i),p,k));}.bind(this));m.subscribe('start',function(o,p){return (this.$XComposerPhotoUploader13(this.$XComposerPhotoUploader20(p,i),p));}.bind(this));m.subscribe('success',function(o,p){return (this.$XComposerPhotoUploader15(this.$XComposerPhotoUploader20(p,i),p));}.bind(this));try{m.send();this.$XComposerPhotoUploader12(i);}catch(n){this.$XComposerPhotoUploader17.error('error_send_unpublished_files',n);throw n;}};h.prototype.getAsyncUploadRequest=function(i,j){var k=new (c('AsyncUploadRequest'))().setData(Object.assign({},j&&j.data,this.$XComposerPhotoUploader2)).setFiles({farr:i}).setAllowCrossOrigin(true).setURI(this.$XComposerPhotoUploader1);if(this.$XComposerPhotoUploader4)k.setLimit(this.$XComposerPhotoUploader4);if(this.$XComposerPhotoUploader5)k.setPreprocessHandler(this.$XComposerPhotoUploader19.bind(this));k.subscribe('start',function(l,m){return (this.$XComposerPhotoUploader13(m.getFile().uploadID,{upload:m}));}.bind(this));k.subscribe('progress',function(l,m){return (this.$XComposerPhotoUploader14(m.getFile().uploadID,{upload:m,event:m.getProgressEvent()}));}.bind(this));k.subscribe('success',function(l,m){return (this.$XComposerPhotoUploader15(m.getFile().uploadID,{upload:m,response:m.getResponse()}));}.bind(this));k.subscribe('failure',function(l,m){return (this.$XComposerPhotoUploader16(m.getFile().uploadID,{upload:m,response:m.getResponse()},i));}.bind(this));return k;};h.prototype.$XComposerPhotoUploader20=function(i,j){if(i.upload){return i.upload.getFile().uploadID;}else return j.uploadID;};h.prototype.$XComposerPhotoUploader19=function(i,j){(function k(){return c('regeneratorRuntime').async(function l(m){while(1)switch(m.prev=m.next){case 0:m.next=2;return c('regeneratorRuntime').awrap(this.$XComposerPhotoUploader21(i,j));case 2:return m.abrupt('return',m.sent);case 3:case 'end':return m.stop();}},null,this);}).bind(this)().done();};h.prototype.$XComposerPhotoUploader22=function i(j){var k;return c('regeneratorRuntime').async(function l(m){while(1)switch(m.prev=m.next){case 0:m.next=2;return c('regeneratorRuntime').awrap(c('ImageMetadata').genMetadataFromBlob(j));case 2:k=m.sent;m.next=5;return c('regeneratorRuntime').awrap(c('SphericalImage').isSphericalImage(j,k));case 5:return m.abrupt('return',m.sent);case 6:case 'end':return m.stop();}},null,this);};h.prototype.$XComposerPhotoUploader23=function(i){var j=this.$XComposerPhotoUploader5,k=c('curry')(this.$XComposerPhotoUploader11,i.uploadID);return new (c('Promise'))(function(l,m){j.resizeBlob(i,function(n,o,p){if(n){m(n);}else if(p){l(null);}else l(o);},k);});};h.prototype.$XComposerPhotoUploader21=function i(j,k){var l,m,n,o,p,q,r;return c('regeneratorRuntime').async(function s(t){while(1)switch(t.prev=t.next){case 0:l=j.getFile();if(!(!l||!c('PhotosMimeType').isJpeg(l.type))){t.next=3;break;}return t.abrupt('return',k(j));case 3:m=c('performanceNow')();this.$XComposerPhotoUploader8(l);t.prev=5;t.next=8;return c('regeneratorRuntime').awrap(c('Promise').all([this.$XComposerPhotoUploader22(l),this.$XComposerPhotoUploader23(l)]));case 8:n=t.sent;o=n[0];p=n[1];if(p&&!o){p.uploadID=l.uploadID;p.name=l.name;j.setFile(p);}q=o||p===null;j.getFile().filename=l.name;this.$XComposerPhotoUploader9(l,p||l,q,c('performanceNow')()-m);t.next=22;break;case 17:t.prev=17;t.t0=t['catch'](5);r=c('performanceNow')()-m;this.$XComposerPhotoUploader10(l,p||l,t.t0,r);case 22:k(j);case 23:case 'end':return t.stop();}},null,this,[[5,17]]);};h.prototype.$XComposerPhotoUploader18=function(i){return !!i.files&&c('AsyncUploadRequest').isSupported();};f.exports=h;},null);