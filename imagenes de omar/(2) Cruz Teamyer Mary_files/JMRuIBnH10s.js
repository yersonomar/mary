/*!CK:4248870792!*//*1457735725,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["FN4II"]); }

__d('FeedTagSuggest',['ArbiterMixin','AsyncRequest','CSS','Event','mixin','SubscriptionsHandler'],function a(b,c,d,e,f,g){var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('mixin')(c('ArbiterMixin')));i=h&&h.prototype;function j(k,l,m,n,o,p,q,r,s,t){'use strict';i.constructor.call(this);this.suggest=k;this.$FeedTagSuggest1=q;this.$FeedTagSuggest2=r;this.$FeedTagSuggest3=s;this.$FeedTagSuggest4=l;this.$FeedTagSuggest5=p;this.$FeedTagSuggest6=o;this.$FeedTagSuggest7=m;this.$FeedTagSuggest8=n;this.$FeedTagSuggest9=t;this.$FeedTagSuggest10=new (c('SubscriptionsHandler'))();this.$FeedTagSuggest10.addSubscriptions(c('Event').listen(this.$FeedTagSuggest5,'click',this.dismissSuggestion.bind(this,'no')),c('Event').listen(this.$FeedTagSuggest6,'click',this.acceptTagSuggestion.bind(this)));if(this.$FeedTagSuggest4)this.$FeedTagSuggest10.addSubscriptions(c('Event').listen(this.$FeedTagSuggest4,'click',this.dismissSuggestion.bind(this,'close')));}j.prototype.dismissSuggestion=function(k){'use strict';var l=this.$FeedTagSuggest9.feed_type;new (c('AsyncRequest'))().setURI('/ajax/dismiss_tag_suggest.php').setMethod('POST').setData({facebox_logs:[{facebox:this.$FeedTagSuggest2,log_data:this.$FeedTagSuggest9}],closing_source:l,closing_action:k}).setAllowCrossPageTransition(true).send();this.inform('remove');};j.prototype.tagSaveSuccess=function(k){'use strict';this.inform('remove');};j.prototype.acceptTagSuggestion=function(){'use strict';new (c('AsyncRequest'))().setURI('/ajax/photo_feed_tagging_ajax.php').setMethod('POST').setData({photo_id:this.$FeedTagSuggest1,facebox_id:this.$FeedTagSuggest2,subject_id:this.$FeedTagSuggest3,log_data:this.$FeedTagSuggest9}).setErrorHandler(this.dismissSuggestion.bind(this,'err')).setAllowCrossPageTransition(true).setHandler(this.tagSaveSuccess.bind(this)).send();if(this.$FeedTagSuggest8){c('CSS').hide(this.$FeedTagSuggest7);c('CSS').show(this.$FeedTagSuggest8);}};j.prototype.cleanup=function(){'use strict';this.$FeedTagSuggest10.release();};f.exports=j;},null);
__d('LitestandTagSuggestContainer',['cx','csx','invariant','Animation','CSS','DOM','DOMQuery','Event','JSXDOM','Rect','SubscriptionsHandler','Style'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();function k(l,m,n,o){'use strict';this.$LitestandTagSuggestContainer1=new (c('SubscriptionsHandler'))();this.$LitestandTagSuggestContainer1.engage();this.$LitestandTagSuggestContainer2=l;this.$LitestandTagSuggestContainer3=n;this.$LitestandTagSuggestContainer4=o;c('CSS').show(this.$LitestandTagSuggestContainer2);var p=new (c('Rect'))(n).w(),q=c('DOMQuery').scry(l,"._5cne"),r=0;for(var s=0;s<q.length;s++){c('CSS').show(q[s]);var t=new (c('Rect'))(q[s].children[0]).w();if(s>0)c('CSS').hide(q[s]);if(t>r)r=t;}if(r>p){c('CSS').hide(l);return;}this.$LitestandTagSuggestContainer5=[];this.$LitestandTagSuggestContainer6=false;m.forEach(this.registerSuggestion.bind(this));this.$LitestandTagSuggestContainer1.addSubscriptions(c('Event').listen(this.$LitestandTagSuggestContainer2,'mouseenter',this.$LitestandTagSuggestContainer7.bind(this)),c('Event').listen(this.$LitestandTagSuggestContainer2,'mouseleave',this.$LitestandTagSuggestContainer8.bind(this)));}k.prototype.registerSuggestion=function(l){'use strict';this.$LitestandTagSuggestContainer5.push(l);var m=l.js_instance;this.$LitestandTagSuggestContainer1.addSubscriptions(m.subscribe('remove',this.onRemove.bind(this,m)));};k.prototype.$LitestandTagSuggestContainer9=function(l){'use strict';if(!this.$LitestandTagSuggestContainer10){var m=this.$LitestandTagSuggestContainer3.children[0];this.$LitestandTagSuggestContainer11={top:parseInt(c('Style').get(m,'top'),10)||0,left:parseInt(c('Style').get(m,'left'),10)||0,inner_h:parseInt(c('Style').get(m,'height'),10),inner_w:parseInt(c('Style').get(m,'width'),10),outer_h:parseInt(c('Style').get(this.$LitestandTagSuggestContainer3,'height'),10),outer_w:parseInt(c('Style').get(this.$LitestandTagSuggestContainer3,'width'),10)};}var n=this.$LitestandTagSuggestContainer11,o=100*(l.top*n.inner_h/100+n.top)/n.outer_h,p=100*(l.left*n.inner_w/100+n.left)/n.outer_w,q=l.width*n.inner_w/n.outer_w,r=l.height*n.inner_h/n.outer_h;return (c('JSXDOM').div({className:"_5cnc hidden_elem",style:{top:o+'%',left:p+'%',width:q+'%',height:r+'%'}}));};k.prototype.onRemove=function(l){'use strict';var m=this.$LitestandTagSuggestContainer5.shift();this.$LitestandTagSuggestContainer8();!(m.js_instance===l)?j(0):undefined;if(this.$LitestandTagSuggestContainer5.length===0){new (c('Animation'))(this.$LitestandTagSuggestContainer2).ondone(function(){this.removeSingleSuggest(this.$LitestandTagSuggestContainer2);}.bind(this)).from('opacity',1).to('opacity',0).ease(c('Animation').ease.end).duration(500).go();this.cleanup();}else new (c('Animation'))(l.suggest).ondone(function(){this.switchToNextSuggest(l.suggest,this.getNextFacebox().suggest);}.bind(this)).from('opacity',1).to('opacity',0).ease(c('Animation').ease.end).duration(500).go();};k.prototype.switchToNextSuggest=function(l,m){'use strict';c('CSS').show(m);new (c('Animation'))(m).ondone(this.removeSingleSuggest.bind(this,l)).from('opacity',0).to('opacity',1).ease(c('Animation').ease.end).duration(500).go();};k.prototype.removeSingleSuggest=function(l){'use strict';c('DOM').remove(l);l.cleanup();};k.prototype.getNextFacebox=function(){'use strict';return this.$LitestandTagSuggestContainer5[0].js_instance;};k.prototype.$LitestandTagSuggestContainer7=function(){'use strict';if(!this.$LitestandTagSuggestContainer6){this.$LitestandTagSuggestContainer6=true;this.$LitestandTagSuggestContainer5.forEach(function(l,m,n){var o=this.$LitestandTagSuggestContainer9(l.position_data);c('DOM').appendContent(this.$LitestandTagSuggestContainer3,o);n[m].dom_element=o;}.bind(this));}this.$LitestandTagSuggestContainer12=this.$LitestandTagSuggestContainer5[0].dom_element;c('CSS').show(this.$LitestandTagSuggestContainer12);};k.prototype.$LitestandTagSuggestContainer8=function(){'use strict';this.$LitestandTagSuggestContainer12&&c('CSS').hide(this.$LitestandTagSuggestContainer12);this.$LitestandTagSuggestContainer12=null;};k.prototype.cleanup=function(){'use strict';this.$LitestandTagSuggestContainer1.release();};f.exports=k;},null);