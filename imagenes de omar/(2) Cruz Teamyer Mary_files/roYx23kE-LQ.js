/*!CK:684535195!*//*1456875956,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["g5lui"]); }

__d('VideoUploadLeaveConfirmationDialog.react',['fbt','React','ReactLayeredComponentMixin','XUIDialog.react','XUIDialogTitle.react','XUIDialogBody.react','XUIDialogFooter.react','XUIDialogButton.react'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('React').PropTypes,j=c('React').createClass({displayName:'VideoUploadLeaveConfirmationDialog',mixins:[c('ReactLayeredComponentMixin')],propTypes:{onContinue:i.func,onCancel:i.func},renderLayers:function(){return {dialog:c('React').createElement(c('XUIDialog.react'),{shown:true,layerHideOnBlur:false,width:700},c('React').createElement(c('XUIDialogTitle.react'),null,h._("\u00bfDescartar publicaci\u00f3n?")),c('React').createElement(c('XUIDialogBody.react'),null,h._("Si sales ahora, la publicaci\u00f3n se descartar\u00e1. Para guardar la publicaci\u00f3n, elige una de las opciones del bot\u00f3n Publicar.")),c('React').createElement(c('XUIDialogFooter.react'),null,c('React').createElement(c('XUIDialogButton.react'),{label:h._("Volver a la publicaci\u00f3n"),onClick:this.props.onContinue}),c('React').createElement(c('XUIDialogButton.react'),{use:'confirm',action:'cancel',label:h._("Descartar"),onClick:this.props.onCancel})))};},render:function(){return c('React').createElement('div',null);}});f.exports=j;},null);
__d('VideoPermalinkText.react',['cx','React','URI'],function a(b,c,d,e,f,g,h){var i,j;if(c.__markCompiled)c.__markCompiled();i=babelHelpers.inherits(k,c('React').Component);j=i&&i.prototype;k.prototype.$VideoPermalinkText1=function(){'use strict';return new (c('URI'))('/video.php').addQueryData('v',this.props.videoID).getQualifiedURI().toString();};k.prototype.render=function(){'use strict';return (c('React').createElement('div',{className:"_9_1"},this.$VideoPermalinkText1()));};function k(){'use strict';i.apply(this,arguments);}f.exports=k;},null);
__d('VideoUploadProcessingDialog.react',['fbt','ActorURI','React','ReactLayeredComponentMixin','VideoEditSource','VideoLibraryButton.react','VideoLibrarySource','VideoPermalinkText.react','XUIDialog.react','XUIDialogTitle.react','XUIDialogBody.react','XUIDialogFooter.react','XUIDialogCloseButton.react','XUIDialogButton.react','XVideoEditController','XVideoEditDialogController'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('React').PropTypes,j=c('React').createClass({displayName:'VideoUploadProcessingDialog',mixins:[c('ReactLayeredComponentMixin')],propTypes:{onClose:i.func,shouldShowNewEditDialog:i.bool,isReferenceVideo:i.bool,shouldShowVideoLibrary:i.bool},getInitialState:function(){return {dialogShown:true};},_onToggle:function(k){this.setState({dialogShown:k});if(!k&&this.props.onClose)this.props.onClose();},_onEditVideoButtonClick:function(){this.setState({dialogShown:false});},componentWillReceiveProps:function(k){if(k.show)this.setState({dialogShown:true});},_getProcessingText:function(){if(this.props.isReferenceVideo){return h._("Tu archivo de referencia se est\u00e1 procesando. Te enviaremos una notificaci\u00f3n cuando est\u00e9 listo y supervisado.");}else if(this.props.isSecretVideo){return (c('React').createElement('div',null,h._("Tu v\u00eddeo secreto se est\u00e1 procesando. Te notificaremos cuando est\u00e9 listo para verse en la ubicaci\u00f3n siguiente:"),c('React').createElement(c('VideoPermalinkText.react'),{videoID:this.props.videoID})));}else return h._("Tu v\u00eddeo se est\u00e1 procesando. Te enviaremos una notificaci\u00f3n cuando est\u00e9 listo para visualizarse.");},_getTitle:function(){return this.props.isSecretVideo?h._("Procesando el v\u00eddeo secreto"):h._("Procesando v\u00eddeo");},renderLayers:function(){var k,l=h._("Editar v\u00eddeo"),m;if(this.props.isReferenceVideo){m=null;}else if(this.props.shouldShowNewEditDialog&&this.props.pageID){k=c('XVideoEditDialogController').getURIBuilder().setInt('video_id',this.props.videoID).setEnum('source',c('VideoEditSource').PROCESSING_DIALOG).getURI();k=c('ActorURI').create(k,this.props.pageID);m=c('React').createElement(c('XUIDialogButton.react'),{action:'confirm',label:l,href:k,onClick:this._onEditVideoButtonClick,rel:'dialog'});}else{k=c('XVideoEditController').getURIBuilder().setInt('v',this.props.videoID).setEnum('source',c('VideoEditSource').PROCESSING_DIALOG).getURI();m=c('React').createElement(c('XUIDialogButton.react'),{action:'confirm',label:l,href:k,onClick:this._onEditVideoButtonClick,target:'_blank'});}var n=null;if(this.props.shouldShowVideoLibrary)n=c('React').createElement(c('VideoLibraryButton.react'),{pageID:this.props.pageID,size:'medium',source:c('VideoLibrarySource').VIDEO_UPLOAD_CONFIRMATION_DIALOG});return {dialog:c('React').createElement(c('XUIDialog.react'),{shown:this.state.dialogShown,width:400,onToggle:this._onToggle},c('React').createElement(c('XUIDialogTitle.react'),null,this._getTitle()),c('React').createElement(c('XUIDialogBody.react'),null,this._getProcessingText()),c('React').createElement(c('XUIDialogFooter.react'),{leftContent:n},c('React').createElement(c('XUIDialogCloseButton.react'),null),m))};},render:function(){return c('React').createElement('span',null);}});f.exports=j;},null);
__d('ComposerXVideoUploadDialog.react',['cx','ix','fbt','Arbiter','DOMContainer.react','Image.react','React','ReactLayeredComponentMixin','SubscriptionsHandler','VideoUploadProcessingDialog.react','XUICloseButton.react','XUIDialog.react','XUIDialogBody.react','XUIDialogTitle.react','VideoUploadLeaveConfirmationDialog.react','OptimisticVideoPostUtils','setImmediate'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k=c('React').PropTypes,l=770,m=489,n=c('React').createClass({displayName:'ComposerXVideoUploadDialog',mixins:[c('ReactLayeredComponentMixin')],_subscriptionsHandler:null,propTypes:{composer:k.object.isRequired,composerID:k.string.isRequired,canShowOptimisticPost:k.bool,showProcessingDialog:k.bool,onCancel:k.func,onComplete:k.func,onDone:k.func,compactMode:k.bool,isReferenceVideo:k.bool},getDefaultProps:function(){return {canShowOptimisticPost:false,showProcessingDialog:true,compactMode:false,isReferenceVideo:false};},getInitialState:function(){return {stage:'editing',videoID:null,showLeaveConfirmationDialog:false,showThrobber:false,shouldShowNewEditDialog:false,pageID:null,isSecretVideo:false,shouldShowVideoLibrary:false};},componentDidMount:function(){var o=new (c('SubscriptionsHandler'))();this._subscriptionsHandler=o;o.addSubscriptions(c('Arbiter').subscribe('videoUpload/started',function(p){this.setState({stage:'editing',videoID:null});}.bind(this)),c('Arbiter').subscribe('videoUpload/complete',function(p,q){if(this.props.onComplete)this.props.onComplete(q.videoID);var r=this.props.showProcessingDialog&&(!this.props.canShowOptimisticPost||!c('OptimisticVideoPostUtils').shouldShowOptimisticPost(q));this.setState({stage:'finished',videoID:q.videoID,shouldShowVideoUploadProcessingDialog:r,shouldShowNewEditDialog:!!q.shouldShowNewEditDialog,pageID:q.pageID,isSecretVideo:q.isSecret,shouldShowVideoLibrary:!!q.shouldShowVideoLibrary});}.bind(this)),c('Arbiter').subscribe('videoUpload/showThrobber',function(p,q){if(this.props.composerID===q.composerID)this.setState({showThrobber:true});}.bind(this)),c('Arbiter').subscribe('videoUpload/hideThrobber',function(p,q){if(this.props.composerID===q.composerID)this.setState({showThrobber:false});}.bind(this)));},componentWillUnmount:function(){if(this._subscriptionsHandler)this._subscriptionsHandler.release();},onCancelPostingClick:function(){this.setState({showLeaveConfirmationDialog:false});if(this.props&&this.props.onCancel)this.props.onCancel();},onContinuePostingClick:function(){this.setState({showLeaveConfirmationDialog:false});},onComposerDialogClose:function(){this.setState({showLeaveConfirmationDialog:true});},onDone:function(){if(this.props&&this.props.onDone){var o=this.props.onDone;c('setImmediate')(function(){return o({videoID:this.state.videoID});}.bind(this));}},renderLayers:function(){if(this.state.stage=='finished'){if(!this.state.shouldShowVideoUploadProcessingDialog){this.onDone();return {};}return {dialog:c('React').createElement(c('VideoUploadProcessingDialog.react'),{videoID:this.state.videoID,onClose:this.onDone,show:true,shouldShowNewEditDialog:this.state.shouldShowNewEditDialog,pageID:this.state.pageID,isReferenceVideo:this.props.isReferenceVideo,isSecretVideo:this.state.isSecretVideo,shouldShowVideoLibrary:this.state.shouldShowVideoLibrary})};}else{var o;if(this.props.isReferenceVideo){o=j._("A\u00f1adir archivo de referencia");}else o=j._("Subir v\u00eddeo");return {dialog:c('React').createElement(c('XUIDialog.react'),{shown:true,layerHideOnBlur:false,width:this.props.compactMode?m:l,fixedTopPosition:100},c('React').createElement(c('XUIDialogTitle.react'),{showCloseButton:false},o,c('React').createElement('div',{className:"_51-u"},this.renderThrobber(),c('React').createElement(c('XUICloseButton.react'),{onClick:this.onComposerDialogClose,className:"_51-t"}))),c('React').createElement(c('XUIDialogBody.react'),{useCustomPadding:true},c('React').createElement(c('DOMContainer.react'),null,this.props.composer)))};}},renderThrobber:function(){return (c('React').createElement(c('Image.react'),{className:"_2z4p"+(this.state.showThrobber?' '+"_2z4q":''),src:i('/images/loaders/indicator_blue_small.gif')}));},render:function(){var o;if(this.state.showLeaveConfirmationDialog)o=c('React').createElement(c('VideoUploadLeaveConfirmationDialog.react'),{onContinue:this.onContinuePostingClick,onCancel:this.onCancelPostingClick});return (c('React').createElement('div',null,o));}});f.exports=n;},null);
__d("XComposerXVideoUploadDialogController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/composerx\/video\/dialog\/",{target_id:{type:"Int",required:true},source_id:{type:"String",required:true},entry_point:{type:"Enum",required:true,enumType:1},is_reference_video:{type:"Bool",defaultValue:false}});},null);
__d('ComposerXVideoUploadDialogController',['fbt','ActorURI','Arbiter','AsyncDialog','AsyncRequest','ComposerEntryPointRef','ComposerXVideoUploadDialog.react','DOM','React','ReactDOM','URI','XComposerXVideoUploadDialogController','goURI'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i={};function j(o){return i[o];}function k(o){i[o.getID()]=o;}function l(o){return o in i;}var m=c('ComposerEntryPointRef').TIMELINE;function n(o,p,q,r,s,t,u){'use strict';this.$ComposerXVideoUploadDialogController1=o;this.$ComposerXVideoUploadDialogController2=p;this.$ComposerXVideoUploadDialogController3=q;this.$ComposerXVideoUploadDialogController4=r;this.$ComposerXVideoUploadDialogController5=s;this.$ComposerXVideoUploadDialogController6=t;this.$ComposerXVideoUploadDialogController7=u;this.$ComposerXVideoUploadDialogController8=n.$ComposerXVideoUploadDialogController9(this.$ComposerXVideoUploadDialogController1,this.$ComposerXVideoUploadDialogController3,this.$ComposerXVideoUploadDialogController6);this.$ComposerXVideoUploadDialogController10=false;this.$ComposerXVideoUploadDialogController11=c('DOM').create('span');c('DOM').appendContent(document.body,this.$ComposerXVideoUploadDialogController11);this.$ComposerXVideoUploadDialogController12();}n.prototype.getID=function(){'use strict';return this.$ComposerXVideoUploadDialogController8;};n.prototype.setFileInput=function(o){'use strict';this.$ComposerXVideoUploadDialogController2=o;};n.prototype.$ComposerXVideoUploadDialogController13=function(o){'use strict';this.$ComposerXVideoUploadDialogController14=o;if(this.$ComposerXVideoUploadDialogController15)this.show();};n.prototype.$ComposerXVideoUploadDialogController12=function(){'use strict';var o=c('XComposerXVideoUploadDialogController').getURIBuilder().setInt('target_id',this.$ComposerXVideoUploadDialogController1).setString('source_id',this.$ComposerXVideoUploadDialogController8).setEnum('entry_point',this.$ComposerXVideoUploadDialogController3).setBool('is_reference_video',this.$ComposerXVideoUploadDialogController7).getURI();o=c('ActorURI').create(o,this.$ComposerXVideoUploadDialogController1);c('AsyncDialog').send(new (c('AsyncRequest'))(o));};n.prototype.$ComposerXVideoUploadDialogController16=function(){'use strict';c('ReactDOM').render(c('React').createElement(c('ComposerXVideoUploadDialog.react'),{canShowOptimisticPost:this.$ComposerXVideoUploadDialogController5,composer:this.$ComposerXVideoUploadDialogController14,composerID:this.$ComposerXVideoUploadDialogController8,isReferenceVideo:this.$ComposerXVideoUploadDialogController7,showProcessingDialog:!this.$ComposerXVideoUploadDialogController4,onCancel:this.$ComposerXVideoUploadDialogController17.bind(this),onDone:this.$ComposerXVideoUploadDialogController18.bind(this)}),this.$ComposerXVideoUploadDialogController11);this.$ComposerXVideoUploadDialogController10=true;};n.prototype.show=function(){'use strict';if(this.$ComposerXVideoUploadDialogController14){this.$ComposerXVideoUploadDialogController15=false;c('Arbiter').inform('ComposerXFilesStore/filesAdded/'+this.$ComposerXVideoUploadDialogController8+'/videoupload',{fileInput:this.$ComposerXVideoUploadDialogController2},c('Arbiter').BEHAVIOR_PERSISTENT);this.$ComposerXVideoUploadDialogController16();}else this.$ComposerXVideoUploadDialogController15=true;};n.prototype.$ComposerXVideoUploadDialogController17=function(){'use strict';c('Arbiter').inform('videoUpload/cancel',{composerID:this.$ComposerXVideoUploadDialogController8});this.hide();};n.prototype.$ComposerXVideoUploadDialogController18=function(o){'use strict';this.hide();if(this.$ComposerXVideoUploadDialogController4)c('goURI')(new (c('URI'))('/'+o.videoID),true);};n.prototype.hide=function(){'use strict';c('ReactDOM').unmountComponentAtNode(this.$ComposerXVideoUploadDialogController11);this.$ComposerXVideoUploadDialogController10=false;};n.$ComposerXVideoUploadDialogController9=function(o,p,q){'use strict';if(q){return q;}else return p+'_'+o;};n.showDialog=function(o){'use strict';o.composerEntryPointRef=o.composerEntryPointRef||m;var p=n.$ComposerXVideoUploadDialogController9(o.targetID,o.composerEntryPointRef,o.originalComposerID);if(!l(p)){k(new n(o.targetID,o.fileInput,o.composerEntryPointRef,o.redirectToPermalinkOnPost||false,o.canShowOptimisticPost||false,o.originalComposerID||'',o.isReferenceVideoUpload||false));}else j(p).setFileInput(o.fileInput);j(p).show();};n.setVideoComposer=function(o,p){'use strict';if(i[o])i[o].$ComposerXVideoUploadDialogController13(p);};f.exports=n;},null);
__d('PhotoInlineOrganizer',['AsyncRequest','AsyncResponse','CSS','DOM','Event','Parent','SortableGroup','$'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i,j){'use strict';this.root=c('$')(i);this.url=j;this.IDLE='idle';this.PENDING='pending';this.SAVING='saving';this.UP='up';this.DOWN='down';this.state=this.IDLE;this.sortable=new (c('SortableGroup'))();this.sortable.setAutoWidth(h.autoWidth);this.sortable.setRequireSameParent(false);this.sortable.setSortablesGetter(function(){return c('DOM').scry(this.root,'div.dragWrapper');}.bind(this));this.sortable.setInsertPlaceholderHandler(this.insertPlaceholder.bind(this));this.sortable.setOrderChangeHandler(this.onSave.bind(this));h.cache[i]=this;h.refresh(i);this.order=this.sortable.getOrder();this.offsetDelta=0;c('Event').listen(this.root,'click',this.moveListener.bind(this));}h.prototype.getItems=function(){'use strict';return c('DOM').scry(this.root,'div.dragWrapper').filter(function(i){return !c('CSS').hasClass(i,'drag');});};h.prototype.moveListener=function(event){'use strict';var i=event.getTarget();if(c('CSS').hasClass(i,'arrow')){this.movePhoto(c('Parent').byClass(i,'dragWrapper'),c('CSS').hasClass(i,this.DOWN)?this.DOWN:this.UP);i.focus();return false;}};h.prototype.movePhoto=function(i,j){'use strict';var k=c('DOM').scry(this.root,'td'),l=this.getItems(),m=l.indexOf(i),n=0;if(j==this.UP&&m>0){n=-1;}else if(j==this.DOWN&&m<l.length-1)n=1;if(n!==0){c('DOM').appendContent(k[m+this.offsetDelta],l[m+n]);c('DOM').appendContent(k[m+n+this.offsetDelta],l[m]);}this.onSave();};h.prototype.save=function(){'use strict';if(this.state!=this.IDLE){this.state=this.PENDING;}else{this.state=this.SAVING;new (c('AsyncRequest'))().setURI(this.url).setMethod('POST').setData({order:this.order}).setHandler(this.saveResponse.bind(this)).setErrorHandler(this.saveResponse.bind(this)).send();}};h.prototype.saveResponse=function(i){'use strict';var j=this.state;this.state=this.IDLE;if(j==this.PENDING)this.save();if(i.getError())c('AsyncResponse').verboseErrorHandler(i);};h.prototype.onSave=function(){'use strict';var i=this.sortable.getOrder();if(i.join('|')!=this.order.join('|')){this.order=i;this.save();}};h.prototype.insertPlaceholder=function(i,j,k){'use strict';var l=c('DOM').scry(this.root,'td'),m=this.getItems(),n=m.indexOf(j),o=m.indexOf(i),p;if(n>o){for(p=o;p<n;p++)c('DOM').appendContent(l[p+this.offsetDelta],m[p+1]);}else for(p=o-1;p>=n;p--)c('DOM').appendContent(l[p+1+this.offsetDelta],m[p]);c('DOM').appendContent(l[n+this.offsetDelta],i);};h.refresh=function(i){'use strict';var j=h.cache[i];c('DOM').scry(j.root,'td').forEach(function(k){if(k.getAttribute('data-id')){var l=c('DOM').find(k,'div.dragWrapper'),m=c('DOM').find(l,'a.uiMediaThumb');j.sortable.addSortable(k.getAttribute('data-id'),l,m);k.removeAttribute('data-id');}});};h.getInlineOrganizer=function(i){'use strict';var j=c('$')(i),k=c('DOM').scry(j,'table')[0];return h.cache[k.id];};h.setOffsetDelta=function(i,j){'use strict';var k=h.getInlineOrganizer(i);k.offsetDelta=Math.max(k.offsetDelta,j);};h.setAutoWidth=function(i,j){'use strict';var k=h.getInlineOrganizer(i);k.sortable.setAutoWidth(j);};h.appendToExisting=function(i,j){'use strict';var k=h.getInlineOrganizer(i),l=c('DOM').find(k.root,'tbody'),m=c('$')(j),n=c('DOM').find(m,'table');c('DOM').scry(n,'tr').forEach(function(p){l.appendChild(p);});var o=c('DOM').scry(m,'.uiMorePager');if(o.length>0)m.appendChild(o[0].parentNode);h.refresh(k.root.id);};h.cache={};f.exports=h;},null);
__d('legacy:photo-inline-organizer-js',['PhotoInlineOrganizer'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();b.PhotoInlineOrganizer=c('PhotoInlineOrganizer');},3);
__d('VideoComposerUploadFileInput',['ComposerXVideoUploadDialogController'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i,j,k,l){'use strict';i.subscribe('change',function(m,event){var n=false,o=false;if(l){n=l.redirectToPermalinkOnPost;o=l.canShowOptimisticPost;}c('ComposerXVideoUploadDialogController').showDialog({targetID:j,fileInput:i,composerEntryPointRef:k,redirectToPermalinkOnPost:n,canShowOptimisticPost:o});});}f.exports=h;},null);