/*!CK:1991631139!*//*1457385233,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["G7t4u"]); }

__d('SeeFirstProfilePopoverMenu',['PopoverMenu'],function a(b,c,d,e,f,g){var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('PopoverMenu'));i=h&&h.prototype;j.prototype._onMenuDone=function(k){'use strict';};function j(){'use strict';h.apply(this,arguments);}f.exports=j;},null);
__d('SubscriptionLevels',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={ALL:'162318810514679',DEFAULT:'271670892858696',TOP:'266156873403755'};f.exports=h;},null);
__d('EditSubscriptions',['csx','cx','Arbiter','AsyncRequest','CSS','DOM','Event','FeedBlacklistButton','MenuDeprecated','Parent','SubscriptionLevels','arrayContains','ge','getOrCreateDOMID'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=45,k=[c('SubscriptionLevels').ALL,c('SubscriptionLevels').DEFAULT,c('SubscriptionLevels').TOP],l={},m={},n={},o={},p={},q={},r={},s={},t={},u={},v={},w="/ajax/follow/follow_profile.php",x="/ajax/follow/unfollow_profile.php",y="/ajax/settings/notifications/notify_me.php",z={},aa={},ba={},ca=null,da={};function ea(cb){return c('arrayContains')(k,cb);}function fa(cb,db,eb,fb){var gb=c('Parent').byClass(fb,'uiMenuItem')||c('Parent').bySelector(fb,"._54ni"),hb=c('getOrCreateDOMID')(cb);if(!gb||!c('DOM').contains(cb,gb)){return;}else if(c('CSS').hasClass(gb,'SubscribeMenuSubscribeCheckbox')){if(n[db]){ka(hb,db);}else ja(hb,db);return false;}else if(c('CSS').hasClass(gb,'SubscribeMenuUnsubscribe')){ka(hb,db);return false;}else if(c('CSS').hasClass(gb,'SubscribeMenuSettingsItem')){wa(cb,true);return false;}else if(c('CSS').hasClass(gb,'SubscriptionMenuGoBack')){wa(cb,false);return false;}else if(c('CSS').hasClass(gb,'SubscriptionMenuItem')){ha(cb,db,eb,gb);return false;}else if(c('CSS').hasClass(gb,'SubscribeMenuNotifyMeCheckbox')){ga(cb,db);return false;}}function ga(cb,db){if(o[db]){ab(cb,db);}else za(cb,db);}function ha(cb,db,eb,fb){if(c('CSS').hasClass(fb,'SubscriptionMenuLevel')){if(c('MenuDeprecated').isItemChecked(fb))return;ua(cb,db,na(fb),true,eb);}else if(c('CSS').hasClass(fb,'SubscriptionMenuCategory')){ra(db,fb,!c('MenuDeprecated').isItemChecked(fb),true,eb);}else if(c('CSS').hasClass(fb,'SubscriptionAppStory'))ta(db,fb,!c('MenuDeprecated').isItemChecked(fb),eb);}function ia(cb){return da[cb]?da[cb]:0;}function ja(cb,db){var eb={profile_id:db};c('Arbiter').inform('FollowingUser',eb);c('Arbiter').inform(c('FeedBlacklistButton').UNBLACKLIST,eb);new (c('AsyncRequest'))().setURI(w).setMethod('POST').setData({profile_id:db,location:ia(cb)}).setErrorHandler(c('Arbiter').inform.bind(null,'FollowUserFail',eb)).send();}function ka(cb,db){var eb={profile_id:db};c('Arbiter').inform('UnfollowingUser',eb);c('Arbiter').inform(c('FeedBlacklistButton').BLACKLIST,eb);new (c('AsyncRequest'))().setURI(x).setMethod('POST').setData({profile_id:db,location:ia(cb)}).setErrorHandler(c('Arbiter').inform.bind(null,'UnfollowUserFail',eb)).send();}function la(cb,db,eb){var fb={profile_id:cb,level:s[cb],custom_categories:t[cb],location:eb};new (c('AsyncRequest'))().setURI('/ajax/follow/manage_subscriptions.php').setData(fb).send();}function ma(cb,db){var eb=t[db]||[],fb=c('MenuDeprecated').getItems(cb);fb.forEach(function(gb){if(c('CSS').hasClass(gb,'SubscriptionMenuCategory')){var hb=na(gb);if(c('arrayContains')(eb,hb)){pa(gb);}else qa(gb);}else if(c('CSS').hasClass(gb,'SubscriptionAppStory')){var ib=na(gb);if(ba[db]&&ba[db][ib]){pa(gb);}else qa(gb);}});ua(cb,db,s[db],false);}function na(cb){var db=c('DOM').scry(cb,'input')[0];return db&&db.value;}function oa(cb){return c('DOM').find(cb,'a.itemAnchor');}function pa(cb){c('CSS').addClass(cb,'checked');oa(cb).setAttribute('aria-checked',true);}function qa(cb){c('CSS').removeClass(cb,'checked');oa(cb).setAttribute('aria-checked',false);}function ra(cb,db,eb,fb,gb){if(eb){pa(db);}else qa(db);var hb=na(db);if(ea(hb)){eb&&sa(cb,hb);}else if(eb){if(!c('arrayContains')(t[cb],hb))t[cb].push(hb);}else{var ib=t[cb].indexOf(hb);if(ib!==-1)t[cb].splice(ib,1);}if(fb)la(cb,hb,gb);}function sa(cb,db){s[cb]=db;c('Arbiter').inform('SubscriptionLevelUpdated',{profile_id:cb,level:db});}function ta(cb,db,eb,fb){var gb='/ajax/feed/filter_action/',hb=na(db),ib={actor_id:cb,app_id:hb};if(eb){pa(db);gb+='resubscribe_user_app/';ib.action='resubscribe_user_app';if(!ba[cb])ba[cb]={};ba[cb][hb]=true;}else{qa(db);gb+='unsubscribe_user_app_checkbox/';ib.action='unsubscribe_user_app_checkbox';if(ba[cb])ba[cb][hb]=false;}new (c('AsyncRequest'))().setURI(gb).setData(ib).send();}function ua(cb,db,eb,fb,gb){var hb=c('DOM').scry(cb,'.SubscriptionMenuLevel'),ib=null;hb.forEach(function(jb){if(na(jb)==eb){ib=jb;}else if(c('MenuDeprecated').isItemChecked(jb))ra(db,jb,false,false);});ib&&ra(db,ib,true,fb,gb);}function va(cb,db,eb){n[db]=eb;c('CSS').conditionClass(cb,'isUnsubscribed',!eb);var fb=c('DOM').scry(cb,'li.SubscribeMenuSubscribeCheckbox');if(fb.length!==0){var gb=fb[0];if(eb){pa(gb);}else qa(gb);}}function wa(cb,db){c('CSS').conditionClass(cb,'subscriptionMenuOpen',db);}function xa(cb,db,eb){var fb=c('DOM').find(cb,".FriendListSubscriptionsMenu"),gb=c('DOM').find(fb,".uiMenuInner");if(ca!=null)ca.forEach(function(hb){gb.removeChild(hb);});eb.forEach(function(hb){gb.appendChild(hb);});ca=eb;}c('Arbiter').subscribe('UnfollowUser',function(cb,db){if(u[db.profile_id]){sa(db.profile_id,u[db.profile_id]);t[db.profile_id]=v[db.profile_id].slice();}});c('Arbiter').subscribe('UpdateSubscriptionLevel',function(cb,db){var eb=db.profile_id+'',fb=db.level+'';sa(eb,fb);var gb;for(gb in l)if(l[gb]===eb){var hb=c('ge')(gb);hb&&ua(hb,eb,fb,false);}});c('Arbiter').subscribe('listeditor/close_editor',function(){var cb;for(cb in l){var db=c('ge')(cb);db&&wa(db,false);}});function ya(cb,db,eb){o[db]=eb;var fb=aa[db];if(fb){if(eb){fb.select();}else fb.deselect();return;}var gb=c('DOM').scry(cb,'li.SubscribeMenuNotifyMeCheckbox');if(gb.length!==0){var hb=gb[0];c('CSS').conditionShow(hb,true);var ib=c('DOM').scry(cb,'li.SubscribeMenuNotifyMeCheckboxSeparator');if(ib.length>0)c('CSS').conditionShow(ib[0],true);if(eb){pa(hb);}else qa(hb);}}function za(cb,db){var eb={profile_id:db};c('Arbiter').inform('EnableNotifsForUser',eb);new (c('AsyncRequest'))().setURI(y).setMethod('POST').setData({notifier_id:db,enable:true}).setErrorHandler(c('Arbiter').inform.bind(null,'EnableNotifsForUserFail',eb)).send();}function ab(cb,db){var eb={profile_id:db};c('Arbiter').inform('DisableNotifsForUser',eb);new (c('AsyncRequest'))().setURI(y).setMethod('POST').setData({notifier_id:db,enable:false}).setErrorHandler(c('Arbiter').inform.bind(null,'DisableNotifsForUserFail',eb)).send();}var bb={init:function(cb,db,eb){var fb=c('getOrCreateDOMID')(cb);da[fb]=eb;if(!l[fb])c('Event').listen(cb,'click',function(gb){return fa(cb,l[fb],eb,gb.getTarget());});if(eb===j&&z[db].length)xa(cb,db,z[db]);if(s[db])ma(cb,db);l[fb]=db;c('CSS').conditionClass(cb,'NonFriendSubscriptionMenu',!m[db]);c('CSS').conditionClass(cb,'cannotSubscribe',!p[db]);c('CSS').conditionClass(cb,'noSubscriptionLevels',q[db]&&!r[db]);c('CSS').conditionClass(cb,'noSubscribeCheckbox',!m[db]&&!q[db]);va(cb,db,n[db]);ya(cb,db,o[db]);c('Arbiter').subscribe(['FollowUser','FollowingUser','UnfollowUserFail'],function(gb,hb){if(hb.profile_id==db)va(cb,db,true);}.bind(this));c('Arbiter').subscribe(['UnfollowUser','UnfollowingUser','FollowUserFail'],function(gb,hb){if(hb.profile_id==db){c('Arbiter').inform('SubMenu/Reset');va(cb,db,false);}}.bind(this));c('Arbiter').subscribe(['EnableNotifsForUser','DisableNotifsForUserFail'],function(gb,hb){if(hb.profile_id==db)ya(cb,db,true);}.bind(this));c('Arbiter').subscribe(['DisableNotifsForUser','EnableNotifsForUserFail'],function(gb,hb){if(hb.profile_id==db)ya(cb,db,false);}.bind(this));c('Arbiter').subscribe('listeditor/friend_lists_changed',function(gb,hb){if(hb.notify_state){var ib=hb.added_uid?hb.added_uid:hb.removed_uid;ya(cb,ib,hb.notify_state.is_notified);}}.bind(this));},getSubscriptions:function(cb){return {level:s[cb],custom_categories:t[cb]};},registerTimelineNotifySelector:function(cb,db){var eb=cb.getInitialMenu(),fb=cb.getContentRoot();eb.forEachItem(function(gb){var hb=gb.getRoot();if(c('CSS').hasClass(hb,'SubscribeMenuNotifyMeCheckbox')){aa[db]=gb;ya(fb,db,o[db]);}});eb.subscribe('itemclick',function(gb,hb){if(hb.item===aa[db])ga(fb,db);return true;});},toggleNotificationsOnJoin:function(cb,db){if(o[cb]!==db)ga(null,cb);},setSubscriptions:function(cb,db,eb,fb,gb,hb,ib,jb,kb,lb,mb,nb){sa(cb,ib+'');m[cb]=db;n[cb]=eb;p[cb]=fb;q[cb]=gb;r[cb]=hb;u[cb]=kb+'';t[cb]=jb.map(String);v[cb]=lb.map(String);z[cb]=nb;o[cb]=mb;}};f.exports=b.EditSubscriptions||bb;},null);
__d('legacy:EditSubscriptions',['SubscriptionLevels','EditSubscriptions'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();b.SubscriptionLevels=c('SubscriptionLevels');b.EditSubscriptions=c('EditSubscriptions');},3);
__d('DynamicFriendListEducation',['Event','Arbiter','AsyncRequest','Dialog','PageTransitionsRegistrar','arrayContains','createArrayFromMixed','removeFromArray'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h,i,j,k,l,m;function n(){j&&j.hide();k&&k.hide();}function o(r){c('removeFromArray')(i,r);n();l({accept_tag_education:true});}function p(){n();l({nux_cancel:true});}var q={init:function(r,s){h=r;i=c('createArrayFromMixed')(s).map(String);c('PageTransitionsRegistrar').registerHandler(function(){n();h=false;l=undefined;i=[];});},showDialog:function(r,s,t){if(h&&c('arrayContains')(i,r)){n();c('Arbiter').inform('DynamicFriendListEducation/dialogOpen',{uid:s,flid:r});l=t;j=new (c('Dialog'))().setAsync(new (c('AsyncRequest'))('/ajax/friends/lists/smart_list_education.php').setMethod('GET').setData({flid:r,uid:s}).setReadOnly(true)).setHandler(o.bind(this,r)).setCloseHandler(function(){c('Arbiter').inform('DynamicFriendListEducation/dialogClosed',{uid:s,flid:r});}).setCancelHandler(function(){c('Arbiter').inform('DynamicFriendListEducation/dialogCancel',{uid:s,flid:r});}).show();}else t();},showContextualDialog:function(r,s,t,u){if(h&&c('arrayContains')(i,r)){n();m=t;l=u;new (c('AsyncRequest'))('/ajax/friends/lists/smart_list_contextual_education.php').setMethod('GET').setData({flid:r,uid:s}).setReadOnly(true).send();}else u();},setContextualDialog:function(r,s,t,u){k=r;k.setContext(m);k.show();c('Event').listen(s,'click',o.bind(this,u));c('Event').listen(t,'click',p);}};f.exports=q;},null);
__d('FriendStatus',['Arbiter','AsyncRequest','SubscribeButton','arrayContains','createArrayFromMixed','forEachObject'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(l,m,n){this.id=l;this.update(m,n);}Object.assign(h.prototype,{update:function(l,m){l&&(this.status=l);if(m){this.lists=c('createArrayFromMixed')(m).map(String);this._informListChange();}},isComplete:function(){return !!this.lists;},addToList:function(l){if(this.lists&&!c('arrayContains')(this.lists,l))this.lists.push(l);this._informListChange();},removeFromList:function(l){if(this.lists){var m=this.lists.indexOf(l);m!==-1&&this.lists.splice(m,1);}this._informListChange();},updateList:function(l,m){m?this.addToList(l):this.removeFromList(l);},_informListChange:function(){c('Arbiter').inform('FriendListMembershipChange',{uid:this.id,lists:this.lists});}});Object.assign(h,{ARE_FRIENDS:1,INCOMING_REQUEST:2,OUTGOING_REQUEST:3,CAN_REQUEST:4});var i={},j={};function k(l,m,n){if(!i[n.uid]){i[n.uid]=new h(n.uid,l);}else i[n.uid].update(l);c('Arbiter').inform('FriendRequest/change',{uid:n.uid,status:l});}c('Arbiter').subscribe(['FriendRequest/cancel','FriendRequest/unfriend'],function(l,m){m.profile_id=m.uid;m.connected=false;c('Arbiter').inform(c('SubscribeButton').UNSUBSCRIBED,m);});c('Arbiter').subscribe(['FriendRequest/cancel','FriendRequest/unfriend','FriendRequest/sendFail'],k.bind(null,h.CAN_REQUEST));c('Arbiter').subscribe(['FriendRequest/confirmFail'],k.bind(null,h.INCOMING_REQUEST));c('Arbiter').subscribe(['FriendRequest/cancelFail','FriendRequest/sent','FriendRequest/sending'],k.bind(null,h.OUTGOING_REQUEST));c('Arbiter').subscribe(['FriendRequest/confirm','FriendRequest/confirming'],k.bind(null,h.ARE_FRIENDS));Object.assign(h,{CLOSE_FRIENDS:null,ACQUAINTANCES:null,getFriend:function(l,m){if(i[l]&&i[l].isComplete()){m(i[l]);}else if(j[l]){j[l].push(m);}else{j[l]=[m];new (c('AsyncRequest'))().setURI("/ajax/friends/status.php").setData({friend:l}).setHandler(function(n){var o=n.getPayload();setTimeout(h.initFriend.bind(h,l,o.status,o.lists),0);}).send();}},initFriend:function(l,m,n){var o=i[l]||new h(l);o.update(o.status||m,o.lists||n);i[l]=o;j[l]&&j[l].forEach(function(p){p(o);});j[l]=null;},setSpecialLists:function(l){var m=h.CLOSE_FRIENDS===null;h.CLOSE_FRIENDS=l.close+'';h.ACQUAINTANCES=l.acq+'';if(m)c('forEachObject')(i,function(n,o){n._informListChange();});}});f.exports=h;},null);
__d('FriendEditLists',['Arbiter','AsyncRequest','CSS','DOMQuery','DynamicFriendListEducation','EditSubscriptions','FriendStatus','MenuDeprecated','Parent','ScrollableArea','URI','$','arrayContains','ge'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=5,i={},j='/ajax/profile/removefriendconfirm.php',k='/ajax/friends/requests/cancel.php',l='/ajax/choose/',m='/profile.php',n,o,p,q,r={profile_browser:43,fbx_top_bar:1,hovercard:5};function s(da,ea,fa){var ga=i[da.id],ha=function(ia){var ja={action:fa?'add_list':'del_list',to_friend:ga.id,friendlists:[ea],source:n};if(ia)Object.assign(ja,ia);ga.updateList(ea,fa);var ka;if(fa&&ea==c('FriendStatus').CLOSE_FRIENDS){ka=v(da,c('FriendStatus').ACQUAINTANCES);if(c('MenuDeprecated').isItemChecked(ka)){c('MenuDeprecated').toggleItem(ka);s(da,c('FriendStatus').ACQUAINTANCES,false);}}else if(fa&&ea==c('FriendStatus').ACQUAINTANCES){ka=v(da,c('FriendStatus').CLOSE_FRIENDS);if(c('MenuDeprecated').isItemChecked(ka)){c('MenuDeprecated').toggleItem(ka);s(da,c('FriendStatus').CLOSE_FRIENDS,false);}}var la={flid:ea,uid:ga.id},ma=fa?'FriendListHovercard/add':'FriendListHovercard/remove';c('Arbiter').inform(ma,la);new (c('AsyncRequest'))().setURI('/ajax/add_friend/action.php').setData(ja).send();};if(fa){c('DynamicFriendListEducation').showDialog(ea,ga.id,ha);}else ha();}function t(da){var ea=c('DOMQuery').scry(da,'input')[0];return ea&&ea.value;}function u(da,ea,fa){if(c('CSS').hasClass(fa,'async_saving'))return;var ga={uid:ea.id};new (c('AsyncRequest'))().setURI(k).setMethod('POST').setData({friend:ea.id,cancel_ref:p,floc:q}).setHandler(c('Arbiter').inform.bind(c('Arbiter'),'FriendRequest/cancel',ga)).setErrorHandler(c('Arbiter').inform.bind(c('Arbiter'),'FriendRequest/cancelFail',ga)).setStatusElement(fa).send();}function v(da,ea){var fa=c('MenuDeprecated').getItems(da);for(var ga=0;ga<fa.length;ga++)if(t(fa[ga])==ea)return fa[ga];return null;}function w(da,ea){var fa=c('MenuDeprecated').getItems(da);fa.forEach(function(ga){var ha=t(ga),ia=c('arrayContains')(ea.lists,ha);if(c('MenuDeprecated').isItemChecked(ga)!==ia)c('MenuDeprecated').toggleItem(ga);});}function x(da){var ea=c('MenuDeprecated').getItems(da),fa=!c('CSS').hasClass(da,'followButtonFlyout')&&!c('CSS').hasClass(da,'likeButtonFlyout'),ga=[],ha=[],ia=0,ja=0;ea.forEach(function(oa){if(c('CSS').hasClass(oa,'neverHide')){c('CSS').removeClass(oa,'underShowMore');ia++;}else if(c('MenuDeprecated').isItemChecked(oa)){ga.push(oa);}else if(c('CSS').hasClass(oa,'neverShow')||c('CSS').hasClass(oa,'FriendListCreateTrigger')||!fa&&c('CSS').hasClass(oa,'friendOptionsOnly')){c('CSS').addClass(oa,'underShowMore');ja++;}else ha.push(oa);});var ka=h-ia,la=ga.concat(ha),ma=ja;la.forEach(function(oa){if(c('CSS').hasClass(oa,'ShowMoreItem')){ka--;return;}if(ka){c('CSS').removeClass(oa,'underShowMore');ka--;}else{c('CSS').addClass(oa,'underShowMore');ma=true;}});c('CSS').conditionClass(da,'hasMoreFriendListItems',ma);var na=c('DOMQuery').scry(da,'.FriendListMenuShowMore');na.forEach(function(oa){c('CSS').removeClass(oa,'FriendListMenuShowMore');});}function y(da,ea){c('CSS').conditionClass(da,'FriendListMemorializedUser',ea);}function z(da,ea){c('CSS').conditionClass(da,'FriendListCannotSuggestFriends',!ea);}function aa(da,ea){var fa=c('DOMQuery').scry(da,'.FriendListUnfriend')[0],ga=c('DOMQuery').scry(da,'.FriendListCancel')[0],ha=c('DOMQuery').scry(da,'.FriendListSuggestFriends')[0],ia=c('DOMQuery').scry(da,'.FriendListFriendship')[0];if(ga)c('CSS').conditionShow(ga,ea.status==c('FriendStatus').OUTGOING_REQUEST);if(fa){c('CSS').conditionShow(fa,ea.id!==undefined&&ea.status===c('FriendStatus').ARE_FRIENDS);var ja=c('DOMQuery').find(fa,'a');ja.setAttribute('ajaxify',new (c('URI'))(j).addQueryData({uid:ea.id,unref:o,floc:q}).toString());}else c('CSS').conditionClass(da,'NoFriendListActionSeparator',!ga||ea.status!=c('FriendStatus').OUTGOING_REQUEST);if(ha)c('DOMQuery').find(ha,'a').setAttribute('href',new (c('URI'))(l).addQueryData({type:'suggest_friends',newcomer:ea.id,ref:'profile_others_dropdown'}).toString());if(ia){c('CSS').conditionShow(ia,ea.status==c('FriendStatus').ARE_FRIENDS);c('DOMQuery').find(ia,'a').setAttribute('href',new (c('URI'))(m).addQueryData({and:ea.id}).toString());}}function ba(da,ea,fa){var ga=c('DOMQuery').scry(da,'div.FriendListSubscriptionsMenu');if(ga.length!==0)c('EditSubscriptions').init(da,ea,fa);}c('Arbiter').subscribe('FriendRequest/change',function(da,ea){for(var fa in i){var ga=c('ge')(fa),ha=i[fa];if(ga&&ha&&ha.id==ea.uid){w(ga,ha);aa(ga,ha);x(ga);}}});c('MenuDeprecated').subscribe('select',function(da,ea){if(c('CSS').hasClass(ea.item,'ShowMoreItem')&&c('CSS').hasClass(ea.menu,'FriendListMenu')){c('CSS').addClass(ea.menu,'FriendListMenuShowMore');c('ScrollableArea').poke(ea.item);}});var ca={init:function(da,ea,fa,ga,ha,ia,ja,ka){da=c('$')(da);n=fa;o=ia;p=ja;q=ka;var la=r[fa]||45;if(!i[da.id])c('MenuDeprecated').subscribe('select',function(ma,na){if(c('DOMQuery').contains(da,na.item))if(c('Parent').byClass(na.item,'FriendListItem')){c('MenuDeprecated').toggleItem(na.item);var oa=t(na.item);s(da,oa,c('MenuDeprecated').isItemChecked(na.item));}else if(c('Parent').byClass(na.item,'FriendListCancel')){u(da,i[da.id],na.item);}else if(c('Parent').byClass(na.item,'FriendListUnfriend'))c('Arbiter').inform('FriendEditLists/unfriend');});c('CSS').addClass(da,'async_saving');c('FriendStatus').getFriend(ea,function(ma){y(da,ga);z(da,ha);w(da,ma);aa(da,ma);i[da.id]=ma;x(da);ba(da,ea,la);c('CSS').removeClass(da,'async_saving');}.bind(this));}};f.exports=b.FriendEditLists||ca;},null);
__d('FriendListFlyoutController',['cx','Event','Arbiter','AsyncRequest','Button','ContextualLayer','CSS','DataStore','Dialog','DOM','DOMQuery','FriendEditLists','FriendStatus','Keys','Layer','LayerHideOnEscape','LayerTabIsolation','MenuDeprecated','Parent','ScrollableArea','Style','TabbableElements','UserAgent_DEPRECATED','emptyFunction'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i,j,k,l=null,m=null,n,o,p,q,r,s,t=1500,u,v=false,w=['uiButtonConfirm','uiButtonSpecial',"_42gz","_42g-","_4jy2","_51tl","_4jy1"],x={init:function(bb,cb){x.init=c('emptyFunction');i=bb;i.subscribe('mouseenter',ga);i.subscribe('mouseleave',function(){if(!v)wa();});i.subscribe('hide',ia);i.enableBehavior(c('LayerTabIsolation'));i.enableBehavior(c('LayerHideOnEscape'));u=cb;if(l)c('DOM').setContent(i.getContent(),[l,m]);var db=function(fb){var gb=c('Parent').byClass(fb.getTarget(),'enableFriendListFlyout');if(gb){v=true;if(n!==gb){k&&ya();va(gb);}}else if(v)ya();},eb=function(fb){var gb=c('Parent').byClass(fb.getTarget(),'enableFriendListFlyout');if(gb)if(n===gb){clearTimeout(q);}else{k&&ya();va(gb);}};c('Event').listen(document.documentElement,{click:db,mouseover:eb,keydown:function(event){var fb=event.getTarget();if(event.getModifiers().any)return;if(!k||c('DOMQuery').isNodeOfType(fb,['input','textarea']))return;var gb=c('Event').getKeyCode(event),hb;switch(gb){case c('Keys').UP:case c('Keys').DOWN:var ib=fa();hb=da(ib);ba(ib[hb+(gb===c('Keys').UP?-1:1)]);return false;case c('Keys').SPACE:var jb=ca(fb);if(jb){y(jb);event.prevent();}break;default:var kb=String.fromCharCode(gb).toLowerCase(),lb=fa();hb=da(lb);var mb=hb,nb=lb.length;while(~hb&&(mb=++mb%nb)!==hb||!~hb&&++mb<nb){var ob=c('MenuDeprecated').getItemLabel(lb[mb]);if(ob&&ob.charAt(0).toLowerCase()===kb){ba(lb[mb]);return false;}}}}});c('Arbiter').subscribe('FriendEditLists/unfriend',ya);c('Arbiter').subscribe('FriendRequest/cancel',ya);c('Arbiter').subscribe('DynamicFriendListEducation/dialogOpen',function(){s=true;});c('Arbiter').subscribe('DynamicFriendListEducation/dialogClosed',function(){s=false;wa();});},initContent:function(bb){c('DOM').appendContent(document.body,bb);ja(bb);setTimeout(function(){if(!l){l=bb;i&&c('DOM').setContent(i.getContent(),[l,m]);c('CSS').show(l);c('Event').listen(l,'click',za);k&&sa(n);}else{c('DOM').remove(bb);bb=null;}},0);},initNux:function(bb){if(m)return;m=bb;i&&c('DOM').setContent(i.getContent(),[l,m]);},show:function(bb){ta(bb);},hide:function(bb){bb===false?ya():wa();},setActiveNode:function(bb){k&&ya();n=bb;o=c('Event').listen(bb,'mouseleave',function(){n=null;o&&o.remove();});},setCloseListener:function(bb,cb){c('DataStore').set(bb,'flfcloselistener',cb);if(n!=bb)c('DataStore').set(bb,'flfcloselistenertimeout',setTimeout(ab.bind(null,bb),t));},setCloseListenerTimeout:function(bb){t=bb;}};function y(bb){c('UserAgent_DEPRECATED').firefox()&&aa(bb).blur();c('MenuDeprecated').inform('select',{menu:z(bb),item:bb});}function z(bb){if(c('CSS').hasClass(bb,'uiMenuContainer'))return bb;return c('Parent').byClass(bb,'uiMenu');}function aa(bb){return c('DOMQuery').find(bb,'a.itemAnchor');}function ba(bb){if(bb&&ea(bb)){c('MenuDeprecated')._removeSelected(i.getContent());c('CSS').addClass(bb,'selected');aa(bb).focus();}}function ca(bb){return c('Parent').byClass(bb,'uiMenuItem');}function da(bb){if(document.activeElement){var cb=ca(document.activeElement);return bb.indexOf(cb);}return -1;}function ea(bb){return !c('CSS').hasClass(bb,'disabled')&&c('Style').get(bb,'display')!=='none'&&c('Style').get(c('Parent').byClass(bb,'uiMenu'),'display')!=='none';}function fa(){return c('MenuDeprecated').getItems(i.getContent()).filter(ea);}function ga(){clearTimeout(q);}function ha(bb){for(var cb=0;cb<w.length;cb++)if(c('CSS').hasClass(bb,w[cb]))return false;return true;}function ia(){if(n){if(ha(n)){c('CSS').removeClass(n,"_52nd");if(c('CSS').hasClass(n,'uiButton')||c('CSS').hasClass(n,"_42fu"))c('CSS').removeClass(n,'selected');}if(c('DataStore').get(n,'flfcloselistener')){var bb=n;c('DataStore').set(n,'flfcloselistenertimeout',setTimeout(ab.bind(null,bb),t));}}k=false;ra();n=null;}function ja(bb){var cb=c('DOMQuery').scry(bb,'[tabindex="0"]');cb.forEach(function(db){db.tabIndex='-1';});cb[0]&&(cb[0].tabIndex='0');}function ka(bb){if(c('DOMQuery').isNodeOfType(bb,'label')&&c('CSS').hasClass(bb,'uiButton'))bb=c('Button').getInputElement(bb);return bb;}function la(bb){return c('DataStore').get(ka(bb),'profileid');}function ma(bb){return c('DataStore').get(ka(bb),'memorialized')==='true';}function na(bb){return c('DataStore').get(ka(bb),'cansuggestfriends')==='true';}function oa(bb){return c('DataStore').get(ka(bb),'unref');}function pa(bb){return c('DataStore').get(ka(bb),'cancelref');}function qa(bb){return c('DataStore').get(ka(bb),'floc');}function ra(){o&&o.remove();o=null;r&&c('Layer').unsubscribe(r);r=null;q&&clearTimeout(q);q=null;}function sa(bb){var cb=la(bb),db=ma(bb),eb=na(bb),fb=c('DataStore').get(bb,'flloc'),gb=oa(bb),hb=pa(bb),ib=qa(bb);c('FriendEditLists').init(l,cb,fb,db,eb,gb,hb,ib);c('CSS').conditionClass(l,'followButtonFlyout',c('CSS').hasClass(bb,'profileFollowButton'));c('CSS').conditionClass(l,'friendButtonFlyout',c('CSS').hasClass(bb,'FriendRequestFriends')||c('CSS').hasClass(bb,'FriendRequestIncoming')||c('CSS').hasClass(bb,'FriendRequestOutgoing'));c('CSS').conditionClass(l,'likeButtonFlyout',c('CSS').hasClass(bb,'profileLikeButton'));var jb=c('DOMQuery').scry(l,'div.uiScrollableArea')[0];jb&&c('ScrollableArea').poke(jb);var kb=c('TabbableElements').find(l)[0];kb&&kb.focus();}function ta(bb){if(!i||k)return;i.setContext(bb);i.setCausalElement(bb);bb.setAttribute('aria-expanded','true');if(ha(bb)){c('CSS').addClass(bb,"_52nd");if(c('CSS').hasClass(bb,'uiButton')||c('CSS').hasClass(bb,"_42fu"))c('CSS').addClass(bb,'selected');}i.show();n=bb;k=true;var cb=null;if(l){cb='show';sa(bb);}else{cb='init_show';new (c('AsyncRequest'))().setURI('/ajax/friends/lists/flyout_content.php').setStatusElement(i.getContent()).send();}ra();o=c('Event').listen(bb,'mouseleave',wa);r=c('Layer').subscribe('show',ua);if(c('DataStore').get(bb,'flfcloselistener'))clearTimeout(c('DataStore').remove(bb,'flfcloselistenertimeout'));var db=la(bb);c('FriendStatus').getFriend(db,function(eb){if(eb.status==c('FriendStatus').ARE_FRIENDS)new (c('AsyncRequest'))().setURI('/ajax/friends/lists/flyout_log.php').setData({target_id:la(bb),unref:oa(bb),action:cb}).send();if(!m)return;if(eb.status==c('FriendStatus').OUTGOING_REQUEST){c('CSS').show(m);c('AsyncRequest').bootstrap('/ajax/friends/lists/nux_flyout.php',null,true);}else c('CSS').hide(m);});if(!j||bb.id!==j.id){c('Arbiter').inform('listeditor/close_editor');c('Arbiter').inform('friend-list/close_editor');}j=bb;}function ua(bb,cb){if(!(cb instanceof c('ContextualLayer'))||!c('DOMQuery').contains(n,cb.getContext()))wa();}function va(bb){n=bb;p=setTimeout(ta.bind(null,bb),u);o=c('Event').listen(bb,'mouseleave',function(){clearTimeout(p);n=null;o&&o.remove();});}function wa(){q=setTimeout(ya,150);}function xa(){var bb=c('Dialog').getCurrent(),cb=bb&&bb.getBody();return !!(cb&&c('DOMQuery').scry(cb,'.friendListDialogTourCarousel')[0]);}function ya(){if(s||xa())return;v=false;if(i){i.hide();var bb=i.getCausalElement();bb&&bb.setAttribute('aria-expanded','false');}}function za(event){var bb=c('Parent').byTag(event.getTarget(),'a');if(bb&&c('CSS').hasClass(bb,'FriendListActionItem'))wa();}function ab(bb){var cb=c('DataStore').remove(bb,'flfcloselistener');cb&&cb();}f.exports=b.FriendListFlyoutController||x;},null);
__d('AddFriendButton',['Event','Arbiter','AsyncRequest','AsyncResponse','collectDataAttributes','CSS','DOMQuery','FriendListFlyoutController','FriendStatus','ge','goURI','Style','SubscribeButton','getVendorPrefixedName','URI','XPubcontentChainedSuggestionsController'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={ERROR_ALREADY_ADDED:1431005,init:function(i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){var x=i.id,y=null,z=c('DOMQuery').scry(i,'.addButton')[0],aa=c('DOMQuery').scry(i,'.addFriendText')[0],ba=c('DOMQuery').scry(i,'.outgoingButton')[0],ca=c('DOMQuery').scry(i,'.incomingButton')[0],da=c('DOMQuery').scry(i,'.friendButton')[0],ea=c('DOMQuery').scry(i.parentNode,'.suggestFriendsButton')[0];function fa(ma,na,oa){var pa=new (c('URI'))(z.getAttribute('ajaxify')),qa=c('collectDataAttributes')(i,['ft','gt']);new (c('AsyncRequest'))().setURI(n).setData({to_friend:j,action:ma,how_found:l,ref_param:m,link_data:qa,outgoing_id:ba.id,xids:pa.getQueryData().xids,logging_location:o,no_flyout_on_click:p,ego_log_data:q,http_referer:s,floc:u,frefs:v}).setErrorHandler(na).setServerDialogCancelHandler(oa).setRelativeTo(ba).send();if(t&&ma==='add_friend'){var ra=c('XPubcontentChainedSuggestionsController').getURIBuilder().setInt('friendid',j).getURI();new (c('AsyncRequest'))().setURI(ra).send();}c('Arbiter').inform(c('SubscribeButton').SUBSCRIBED,{profile_id:j.toString(),connected:true,chaining:false});}function ga(ma,na){if(aa){c('CSS').hide(aa);}else if(z){if(w)c('CSS').hide(w);c('CSS').hide(z);}ba&&c('CSS').hide(ba);ca&&c('CSS').hide(ca);da&&c('CSS').hide(da);if(ma){c('CSS').show(ma);if(w&&'Requestable'===na)c('CSS').show(w);}if('Outgoing'==na&&y!=na&&r){var oa=c('getVendorPrefixedName')('transition'),pa=c('Style').get(ma,oa),qa={backgroundColor:'transparent',borderColor:c('Style').get(ma,'borderLeftColor')};qa[oa]='2s';var ra=c('Event').listen(ma,c('getVendorPrefixedName')('transitionend'),function(){c('Style').apply(ma,{transition_prop:pa});ra.remove();});c('Style').apply(ma,qa);}if('Requestable'==na&&y!=na)ea&&c('CSS').hide(ea);y&&c('CSS').removeClass(i,'fStatus'+y);y=na;c('CSS').addClass(i,'fStatus'+na);}function ha(ma){if(c('CSS').hasClass(ma,'enableFriendListFlyout')){c('FriendListFlyoutController').show(ma);}else c('FriendListFlyoutController').hide();}var ia=c('Arbiter').subscribe('FriendRequest/change',function(ma,na){la();if(na.uid!=j)return;switch(na.status){case c('FriendStatus').ARE_FRIENDS:return ga(da,'Friends');case c('FriendStatus').INCOMING_REQUEST:return ga(ca,'Incoming');case c('FriendStatus').OUTGOING_REQUEST:return ga(ba,'Outgoing');case c('FriendStatus').CAN_REQUEST:return ga(aa?aa:z,'Requestable');}}),ja=c('Arbiter').subscribe('FriendRequest/unfriend',function(ma,na){la();if(na.uid===j&&na.shouldHideButton===true)c('CSS').hide(z);}),ka;if(k)ka=c('Arbiter').subscribe('FriendRequest/confirm',function(ma,na){la();na.uid==j&&c('goURI')(k);});z&&c('Event').listen(z,'click',function(){c('Arbiter').inform('FriendRequest/sending',{uid:j});if(p){c('FriendListFlyoutController').setActiveNode(ba);}else ha(ba);fa("add_friend",function(ma){var na=ma.error==h.ERROR_ALREADY_ADDED?'FriendRequest/sent':'FriendRequest/sendFail';c('Arbiter').inform(na,{uid:j});c('FriendListFlyoutController').hide();c('AsyncResponse').defaultErrorHandler(ma);},function(ma){c('Arbiter').inform('FriendRequest/sendFail',{uid:j});c('FriendListFlyoutController').hide();});});function la(){if(c('ge')(x))return;ia&&ia.unsubscribe();ka&&ka.unsubscribe();ja&&ja.unsubscribe();ia=null;ka=null;ja=null;}}};f.exports=h;},null);
__d('FriendButtonIcon',['Arbiter','FriendStatus','Button','arrayContains'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();f.exports={register:function(h,i,j){c('Arbiter').subscribe('FriendListMembershipChange',function(k,l){if(l.uid==j){var m=c('arrayContains')(l.lists,c('FriendStatus').CLOSE_FRIENDS),n=c('arrayContains')(l.lists,c('FriendStatus').ACQUAINTANCES);if(m&&!n){c('Button').setIcon(h,i.close);}else if(n&&!m){c('Button').setIcon(h,i.acquaintance);}else c('Button').setIcon(h,i.friend);}});}};},null);